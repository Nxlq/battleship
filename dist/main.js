(()=>{"use strict";const e=e=>{let t=0;return{length:e,isSunk:!1,hit:function(){return t+=1,t},getHitCount:function(){return console.log(t),t},checkIfSunk:function(){return e-t<=0}}},t=()=>{let t=!1;const o=[],n=[];function r(){t=!0!==t}const i={carrier:e(5),battleship:e(4),cruiser:e(3),submarine:e(3),destroyer:e(2)};let l=0;function s(){return l}const c=new Map([]);for(let e=0;e<10;e+=1)for(let t=0;t<10;t+=1)c.set([e,t].toString(),"water");const a=()=>0!==Object.values(i).filter((e=>!e.checkIfSunk())).length;return{getBoard:()=>(console.log(c),c),setShip:(e,t,o="h")=>{if(!function(e,t,o){const n=i[t].length,r="h"===o?[e[0],e[1]+n]:[e[0]+n,e[1]];return r[0]>=0&&r[0]<=9&&r[1]>=0&&r[1]<=9}(e,t,o))return console.error("invalid placement position");const n=i[t].length;for(let r=0;r<n;r+=1){const n="h"===o?[e[0],e[1]+r]:[e[0]+r,e[1]];if(console.log({coord:e,coordsToSet:n}),"water"!==c.get(n.toString()))return console.error("Invalid Coords");c.set(n.toString(),t),l+=1,console.log(s())}return s()},logShips:()=>{console.log(i)},receiveAttack:e=>{if(!t)return console.log("board can not be currently attacked"),!1;const l=e.toString();return!o.includes(l)&&(!n.includes(l)&&("water"!==c.get(l)?(i[c.get(l)].hit(),o.push(l),a()?(r(),c.get(l)):"game over"):(n.push(e.toString()),r(),c.get(l))))},getShipHitcount:function(e){return i[e].getHitCount()},missedAttacks:n,hasShipsAlive:a,toggleBoardState:r,isBoardActive:function(){return console.log(t),t},getShipsPlacedCount:s}},o=document.getElementById("btn-start-game"),n=document.querySelectorAll(".game-board"),r=document.querySelectorAll('[draggable="true"]'),i=document.querySelector(".game-board.one"),l=(document.querySelector(".game-board.two"),document.querySelector(".game-container.one")),s=document.querySelector(".game-container.two"),c=(document.querySelector("body"),{piecesToTheRight:null,shipLength:null,piecesToTheLeft:null,shipDirection:"v",shipType:null,curCoord:null,shipHeadCoord:null});function a(e){console.log("start",e),[c.shipType]=e.target.classList,setTimeout((()=>{this.classList.add("invisible")}),0)}function d(e){}function g(e){e.preventDefault(),console.log("over"),e.target.classList.add("hovered");let t=e.target.nextElementSibling;for(let e=0;e<c.piecesToTheRight;e+=1)t.classList.add("hovered"),t=t.nextElementSibling;const o=c.shipLength-(c.piecesToTheRight+1);let n=e.target.previousElementSibling;for(let e=0;e<o;e+=1)n.classList.add("hovered"),n=n.previousElementSibling}function u(e){e.preventDefault(),console.log("enter"),console.log("TARGET",e.target),console.log(e.target.nextElementSibling)}function h(e){console.log("leave"),console.log("TARGET",e.target),e.target.classList.remove("hovered");let t=e.target.nextElementSibling;for(let e=0;e<c.piecesToTheRight;e+=1)t.classList.remove("hovered"),t=t.nextElementSibling;const o=c.shipLength-(c.piecesToTheRight+1);let n=e.target.previousElementSibling;for(let e=0;e<o;e+=1)n.classList.remove("hovered"),n=n.previousElementSibling}function m(e,t,o){console.log("drop"),this.classList.remove("hovered"),this.classList.add("fill"),c.curCoord=this.getAttribute("coords").split(",").map((e=>+e)),c.shipHeadCoord="h"===c.shipDirection?[c.curCoord[0],c.curCoord[1]-c.piecesToTheLeft]:[c.curCoord[0]-c.piecesToTheLeft,c.curCoord[1]],console.log(c.shipHeadCoord),console.log(e.target);let n=e.target.nextElementSibling;for(let e=0;e<c.piecesToTheRight;e+=1)n.classList.remove("hovered"),n.classList.add("fill"),n=n.nextElementSibling;const r=c.shipLength-(c.piecesToTheRight+1);let i=e.target.previousElementSibling;for(let e=0;e<r;e+=1)i.classList.remove("hovered"),i.classList.add("fill"),i=i.previousElementSibling}r.forEach((e=>{console.log(e),e.addEventListener("dragstart",a),e.addEventListener("dragend",d),e.addEventListener("mousedown",(e=>{console.log(e),function(e){const t=e.parentElement.getAttribute("data-length");let o=0,n=e;for(;n.nextElementSibling;)console.log(n.nextElementSibling),n=n.nextElementSibling,o+=1;c.piecesToTheRight=o,c.shipLength=t,c.piecesToTheLeft=c.shipLength-(c.piecesToTheRight+1)}(e.target)}))}));const p={gameboard:t()},v=(()=>{const e=t();function o(e,t){return Math.floor(Math.random()*(t-e+1)+1)}return{gameboard:e,getValidCoords:function(){let t=[o(0,9),o(0,9)];for(;e.missedAttacks.includes(t.toString());)t=[o(0,9),o(0,9)];return t}}})();function f(){return p.gameboard.isBoardActive()?(l.style.backgroundColor="#9c0000",void(s.style.backgroundColor="black")):v.gameboard.isBoardActive()?(s.style.backgroundColor="#9c0000",void(l.style.backgroundColor="black")):"error neither board is active?"}window.addEventListener("DOMContentLoaded",(()=>{n.forEach((e=>{const t=[...e.children];let o=0,n=0;t.forEach((e=>{n>9&&(n=0,o+=1),e.setAttribute("coords",`${o},${n}`),n+=1}))})),p.gameboard.setShip,v.gameboard.setShip,console.log(i.childNodes),i.childNodes.forEach((e=>{e.addEventListener("dragover",g),e.addEventListener("dragenter",u),e.addEventListener("dragleave",h),e.addEventListener("drop",m)}))})),o.addEventListener("click",(()=>{p.gameboard.getBoard(),v.gameboard.getBoard()})),n.forEach((e=>{e.addEventListener("click",f)}))})();
//# sourceMappingURL=main.js.map